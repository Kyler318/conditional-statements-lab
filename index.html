<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº’å‹•æ•™å­¸ï¼šæ¢ä»¶èªå¥ (Conditional Statements)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f0f4f8; color: #4a4a4a; }
        .code-block { font-family: 'Courier New', Courier, monospace; }
        .flowchart-diamond {
            width: 80px; height: 80px; transform: rotate(45deg);
            display: flex; align-items: center; justify-content: center;
            border: 2px solid #d97706; background-color: #fffbeb;
            margin: 20px auto;
            transition: all 0.2s ease-in-out; /* Add transition for smoothness */
        }
        .flowchart-content { transform: rotate(-45deg); text-align: center; width: 100%; font-size: 0.8rem; font-weight: bold; }
        .flowchart-rect {
            border: 2px solid #3b82f6; background-color: #eff6ff;
            padding: 10px; border-radius: 8px; width: 120px; text-align: center; font-size: 0.9rem;
            margin: 10px auto;
            transition: all 0.2s ease-in-out; /* Add transition for smoothness */
        }
        /* Enhanced Arrow Styling for Flowcharts */
        .arrow-path { position: relative; width: 100%; height: 20px; text-align: center; }
        .arrow-path::after { content: 'â–¼'; position: absolute; left: 50%; top: 0; transform: translateX(-50%); font-size: 16px; color: #9ca3af; } 
        
        /* New Merge Component for Cleaner Junctions */
        .flow-merge-point { @apply w-full flex justify-center h-8 relative; }
        .flow-merge-point .path-line-left { @apply absolute w-1/2 h-full border-b-2 border-l-2 border-gray-400 top-0 left-0 rounded-bl-lg; transition: border-color 0.2s; }
        .flow-merge-point .path-line-right { @apply absolute w-1/2 h-full border-b-2 border-r-2 border-gray-400 top-0 right-0 rounded-br-lg; transition: border-color 0.2s; }
        .flow-merge-point .arrow-head { @apply absolute bottom-0 text-xl text-gray-400; }
        
        /* Highlight for Code Simulation - STRONGER VISIBILITY */
        .highlight-line { 
            background-color: #fcd34d; /* Amber 300 - Much more noticeable */
            transition: background-color 0.1s; 
        }
        
        /* Enhanced Visuals for True Path in Flowchart (Per user request) */
        .flowchart-diamond.true-path {
            background-color: #34d399 !important; /* Emerald 400 */
            border-color: #059669 !important; /* Emerald 600 */
        }
        .flowchart-rect.true-action {
            opacity: 1 !important;
            background-color: #a7f3d0 !important; /* Green 300 */
            border-color: #059669 !important; /* Green 600 */
            font-weight: bold;
        }

        /* --- NEW SIMULATOR STYLES --- */
        .status-box {
            /* Applied via JS, but base style needed */
            @apply p-3 rounded-xl shadow-md font-medium w-32;
            border: 1px solid currentColor;
        }

        /* Animation for time pulse */
        @keyframes pulse-time {
            0%, 100% { transform: scale(1); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
            50% { transform: scale(1.005); box-shadow: 0 0 15px 5px rgba(252, 211, 77, 0.6); } /* Stronger yellow glow */
        }
        .animate-pulse-time {
            animation: pulse-time 0.5s ease-in-out;
        }

        /* Chart Container Styling - Mandatory */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container { height: 350px; }
        }

        /* Simulator Specific Styles */
        .time-display-sim {
            background-color: #334155;
            color: #fcd34d;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        /* Quiz Input Styling - Generic */
        .quiz-input-field {
            @apply w-12 text-center border-b-2 border-gray-400 bg-transparent focus:outline-none;
        }

        /* Quiz 2 Specific Styling (Text Box Style - Now Deprecated, kept for reference) */
        .quiz-box-input {
            @apply bg-white border border-gray-300 rounded px-3 py-1 text-center text-sm focus:border-emerald-500 focus:outline-none focus:ring-1 focus:ring-emerald-500 placeholder-gray-400 font-mono;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <header class="max-w-4xl mx-auto mb-10 text-center">
        <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-4">æ¢ä»¶èªå¥äº’å‹•å¯¦é©—å®¤ (åŠæ ¼åˆ†æ•¸: 50)</h1>
        <p class="text-lg text-gray-600">æ•™æ¡ˆä¸»é¡Œï¼šå­¸æœƒè®“é›»è…¦åšæ±ºå®š (Conditional Statements)</p>
        <div class="mt-4 flex flex-wrap justify-center gap-4 text-sm text-gray-500">
            <span class="bg-white px-3 py-1 rounded shadow-sm border border-gray-200">â± æ™‚é•·ï¼š35 åˆ†é˜</span>
            <span class="bg-white px-3 py-1 rounded shadow-sm border border-gray-200">ğŸ èªè¨€ï¼šPython</span>
            <span class="bg-white px-3 py-1 rounded shadow-sm border border-gray-200">ğŸ¯ ç›®æ¨™ï¼šæ¢ä»¶èªå¥çš„é‚è¼¯å’Œèªæ³•</span>
        </div>
    </header>

    <section class="max-w-4xl mx-auto mb-12 bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden p-6 md:p-8">
        <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6 text-center border-b pb-4">æƒ…å¢ƒé¸æ“‡:ä¸Šå­¸å‡ºè¡Œæ¨¡æ“¬å™¨</h2>
        <p class="text-gray-600 mb-6 text-center">
            é€™æ˜¯ä¸€å€‹è¤‡é›œçš„**å¤šå±¤æ¢ä»¶åˆ¤æ–·**æ‡‰ç”¨ã€‚ä½ éœ€è¦åœ¨9:30å‰å›åˆ°å­¸æ ¡ï¼Œä½ çš„æ¯å€‹é¸æ“‡éƒ½æœƒå½±éŸ¿ä½ çš„æ™‚é–“ (time) å’Œç‹€æ…‹ (state)ï¼Œæœ€çµ‚æ±ºå®šä½ çš„çµå±€ã€‚
        </p>

        <div id="simulator-app" class="w-full bg-stone-50 rounded-lg p-6 md:p-8 border border-stone-200 transition-all duration-300">
            <div class="flex justify-between items-center mb-6">
                <div class="time-display-sim">
                    â° æ™‚é–“: <span id="current-time-sim">08:40</span>
                </div>
                <h1 class="text-xl font-bold text-gray-800">ğŸš¦ æ±ºç­–ä¸­...</h1>
            </div>

            <div class="flex flex-wrap justify-center gap-4 mb-8 text-center">
                <div id="weather-status-sim" class="status-box bg-gray-100 text-gray-800 transition duration-300">
                    <span class="text-2xl">â“</span><br>å¤©æ°£ç‹€æ…‹
                </div>
                <div id="umbrella-status-sim" class="status-box bg-gray-100 text-gray-800 transition duration-300">
                    <span class="text-2xl">â“</span><br>é›¨å‚˜ç‹€æ…‹
                </div>
                <div id="state-status-sim" class="status-box bg-yellow-100 text-yellow-800 transition duration-300">
                    <span class="text-2xl">ğŸƒ</span><br>å€‹äººç‹€æ…‹
                </div>
            </div>


            <div id="game-content-sim">
                <p id="scenario-text-sim" class="text-lg mb-8 text-gray-700 leading-relaxed"></p>

                <div id="choice-buttons-sim" class="space-y-4">
                    </div>
            </div>
        </div>
    </section>

    <section class="max-w-4xl mx-auto mb-12 bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
        <div class="p-6 md:p-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">1. åˆ¤æ–·æ¨™æº–ï¼šå¸ƒæ—å€¼ (Boolean)</h2>
            <p class="text-gray-600 mb-6">
                é›»è…¦åªæ‡‚å…©ç¨®å›ç­”ï¼š<span class="font-mono text-blue-600 font-bold">True (çœŸ)</span> èˆ‡ <span class="font-mono text-red-500 font-bold">False (å‡)</span>ã€‚
                è«‹è¼¸å…¥<b>æ•¸å­—</b>æˆ–<b>æ–‡å­—</b>ï¼Œä¸¦é¸æ“‡æ“ä½œç¬¦ä¾†é€²è¡Œæ¯”è¼ƒã€‚
            </p>

            <div class="bg-slate-800 text-white p-6 rounded-xl shadow-inner">
                <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4">
                    <input type="text" id="bool-num1" value="10" class="w-36 text-center bg-slate-700 border border-slate-600 rounded p-2 text-xl font-mono focus:outline-none focus:border-blue-500" oninput="checkBoolean()">
                    
                    <select id="bool-op" class="bg-slate-700 border border-slate-600 rounded p-2 text-xl font-mono cursor-pointer focus:outline-none focus:border-blue-500" onchange="checkBoolean()">
                        <option value=">">&gt; (å¤§æ–¼)</option>
                        <option value="<">&lt; (å°æ–¼)</option>
                        <option value="==">== (ç­‰æ–¼)</option>
                        <option value="!=">!= (ä¸ç­‰æ–¼)</option>
                        <option value=">=">&gt;= (å¤§æ–¼ç­‰æ–¼)</option>
                        <option value="<=">&lt;= (å°æ–¼ç­‰æ–¼)</option>
                    </select>
                    
                    <input type="text" id="bool-num2" value="Hello" class="w-36 text-center bg-slate-700 border border-slate-600 rounded p-2 text-xl font-mono focus:outline-none focus:border-blue-500" oninput="checkBoolean()">
                    
                    <div class="text-2xl font-mono">â¡</div>
                    <div id="bool-result" class="text-3xl font-mono font-bold text-green-400">False</div>
                </div>
                <p class="text-center text-slate-400 mt-4 text-sm">è©¦è‘—ä¿®æ”¹å…©å´çš„å€¼ (æ•¸å­—/æ–‡å­—) æˆ–ç¬¦è™Ÿï¼Œçœ‹çœ‹é›»è…¦å¦‚ä½•åˆ¤æ–·ï¼</p>
            </div>
        </div>
    </section>

    <section class="max-w-4xl mx-auto mb-12 bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
        <div class="p-6 md:p-8 border-b border-gray-100">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">2. ç‚ºä»€éº¼éœ€è¦ã€Œæ¢ä»¶ã€ï¼Ÿ</h2>
            <p class="text-gray-600 mb-6 leading-relaxed">
                ç¨‹å¼çš„æ ¸å¿ƒåœ¨æ–¼<b>åšæ±ºå®š</b>ã€‚å°±åƒåœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼Œæˆ‘å€‘ç„¡æ™‚ç„¡åˆ»ä¸åœ¨æ ¹æ“šæƒ…æ³åšå‡ºé¸æ“‡ã€‚
                <br>é€™å°±æ˜¯ç¨‹å¼ä¸­çš„<b>ã€Œæ¢ä»¶èªå¥ã€</b>ã€‚
            </p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                <div class="bg-stone-50 p-6 rounded-lg">
                    <h3 class="font-bold text-gray-700 mb-3">ç”Ÿæ´»ä¸­çš„é‚è¼¯ï¼š</h3>
                    <div class="space-y-4">
                        <div class="flex items-center space-x-3 cursor-pointer p-2 hover:bg-stone-100 rounded transition" onclick="toggleRain(true)">
                            <div class="w-8 h-8 flex items-center justify-center bg-blue-100 text-blue-600 rounded-full font-bold">A</div>
                            <div>å¦‚æœ <b>ä¸‹é›¨</b> ğŸŒ§ï¸ <span class="text-gray-400">-></span> å¸¶é›¨å‚˜ â˜”</div>
                        </div>
                        <div class="flex items-center space-x-3 cursor-pointer p-2 hover:bg-stone-100 rounded transition" onclick="toggleRain(false)">
                            <div class="w-8 h-8 flex items-center justify-center bg-orange-100 text-orange-600 rounded-full font-bold">B</div>
                            <div>å¦å‰‡ <b>(æ²’ä¸‹é›¨)</b> â˜€ï¸ <span class="text-gray-400">-></span> ç›´æ¥å‡ºé–€ ğŸƒ</div>
                        </div>
                    </div>
                </div>
                <div class="text-center">
                    <div id="rain-feedback" class="text-6xl mb-4 transition-all duration-300">ğŸ¤”</div>
                    <p id="rain-text" class="font-bold text-xl text-gray-700">é»æ“Šå·¦å´æƒ…å¢ƒä¾†åšæ±ºå®š</p>
                </div>
            </div>
        </div>
    </section>

    <section class="max-w-4xl mx-auto mb-12">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">3. èªæ³•å¯¦é©—å®¤ (Syntax Workshop)</h2>
        
        <div class="flex space-x-2 mb-6 overflow-x-auto pb-2">
            <button onclick="switchTab('single')" id="tab-single" class="tab-btn px-6 py-2 rounded-full bg-blue-600 text-white font-medium shadow transition-all hover:bg-blue-700">å–®åˆ†æ”¯ (if)</button>
            <button onclick="switchTab('double')" id="tab-double" class="tab-btn px-6 py-2 rounded-full bg-white text-gray-600 font-medium border border-gray-200 hover:bg-gray-50 transition-all">é›™åˆ†æ”¯ (if-else)</button>
            <button onclick="switchTab('multi')" id="tab-multi" class="tab-btn px-6 py-2 rounded-full bg-white text-gray-600 font-medium border border-gray-200 hover:bg-gray-50 transition-all">å¤šåˆ†æ”¯ (if-elif-else)</button>
        </div>

        <div class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 md:p-8 min-h-[500px]">
            
            <div id="content-single" class="branch-content">
                <div class="mb-6 border-l-4 border-blue-500 pl-4">
                    <h3 class="text-xl font-bold text-gray-800">å–®åˆ†æ”¯ (If Statement)</h3>
                    <p class="text-gray-600">æƒ…å¢ƒï¼šåªæœ‰ã€Œæ»¿è¶³æ¢ä»¶ã€æ™‚æ‰åšäº‹ï¼Œä¸æ»¿è¶³å°±ç›´æ¥è·³éã€‚ <span class="text-red-500 font-bold">(æ³¨æ„: åŠæ ¼åˆ†æ•¸ç¾ç‚º 50 åˆ†)</span></p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="flex flex-col items-center bg-stone-50 p-4 rounded-lg">
                        <h4 class="font-bold text-gray-500 mb-4 text-sm tracking-wide">é‚è¼¯æµç¨‹åœ–</h4>
                        <div class="flex flex-col items-center w-full">
                            <div class="flowchart-rect">é–‹å§‹</div>
                            <div class="arrow-path"></div>
                            <div class="flowchart-diamond" id="single-diamond">
                                <div class="flowchart-content">åˆ†æ•¸ >= 50?</div>
                            </div>
                            
                            <div class="flex w-full justify-between items-start mt-2">
                                <div class="flex flex-col items-center w-1/2 pr-2">
                                    <div class="text-green-600 text-sm font-bold mb-1 -mt-4">âœ“ True</div>
                                    <div class="arrow-path w-full -mt-2"></div>
                                    <div class="flowchart-rect bg-green-100 border-green-400" id="single-action">åŸ·è¡Œ: é¡¯ç¤º "Pass"</div>
                                    <div class="text-xs text-gray-400 h-[50px] flex items-center justify-center pt-2"></div> 
                                </div>
                                
                                <div class="flex flex-col items-center w-1/2 pl-2">
                                    <div class="text-red-500 text-sm font-bold mb-1 -mt-4">âœ— False</div>
                                    <div class="arrow-path w-full opacity-0"></div> <div class="text-xs text-gray-400 h-[50px] flex items-center justify-center pt-2">--- (è·³é) ---</div> 
                                </div>
                            </div>

                            <div class="flow-merge-point">
                                <div class="path-line-left" id="single-merge-left"></div>
                                <div class="path-line-right" id="single-merge-right"></div>
                                <div class="arrow-head">â†“</div>
                            </div>

                            <div class="flowchart-rect mt-[-20px]">çµæŸ</div>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <div class="bg-gray-900 rounded-lg p-4 text-gray-200 text-sm shadow-lg font-mono leading-relaxed">
                            <div class="text-gray-500"># ç¯„ä¾‹ï¼šåŠæ ¼åˆ¤æ–· (50åˆ†åˆæ ¼)</div>
                            <div>score = <span id="code-single-val" class="text-purple-400">45</span></div>
                            <div id="line-single-1" class="pl-0 transition-colors duration-200">
                                <span class="text-pink-500">if</span> score >= <span class="text-orange-400">50</span>:
                            </div>
                            <div id="line-single-2" class="pl-4 transition-colors duration-200">
                                print(<span class="text-green-400">"Pass"</span>)
                            </div>
                        </div>

                        <div class="bg-blue-50 p-6 rounded-lg border border-blue-100">
                            <label class="block text-sm font-bold text-gray-700 mb-2">è©¦è©¦çœ‹ï¼šè¼¸å…¥åˆ†æ•¸</label>
                            <input type="range" min="0" max="100" value="45" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer mb-2" id="single-slider" oninput="updateSingle()">
                            <div class="flex justify-between items-center">
                                <span class="text-2xl font-bold text-blue-600" id="single-display">45</span>
                                <span class="px-3 py-1 bg-white rounded shadow text-sm font-bold" id="single-status">ä¸åŠæ ¼ (ç„¡å‹•ä½œ)</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="content-double" class="branch-content hidden">
                <div class="mb-6 border-l-4 border-purple-500 pl-4">
                    <h3 class="text-xl font-bold text-gray-800">é›™åˆ†æ”¯ (If-Else)</h3>
                    <p class="text-gray-600">æƒ…å¢ƒï¼šäºŒé¸ä¸€ (éé»‘å³ç™½)ã€‚æ¢ä»¶æˆç«‹èµ°é€™æ¢è·¯ï¼Œå¦å‰‡èµ°å¦ä¸€æ¢è·¯ã€‚</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="flex flex-col items-center bg-stone-50 p-4 rounded-lg">
                        <h4 class="font-bold text-gray-500 mb-4 text-sm tracking-wide">é‚è¼¯æµç¨‹åœ–</h4>
                        <div class="flex flex-col items-center">
                            <div class="flowchart-rect">é–‹å§‹</div>
                            <div class="arrow-path"></div>
                            <div class="flowchart-diamond" id="double-diamond">
                                <div class="flowchart-content">å¹´é½¡ >= 12?</div>
                            </div>
                            <div class="flex w-full justify-around mt-[-10px] relative z-10 px-4">
                                <div class="text-green-600 text-sm font-bold bg-white px-1 ml-[-20px]">âœ“ True</div>
                                <div class="text-red-500 text-sm font-bold bg-white px-1 mr-[-20px]">âœ— False</div>
                            </div>
                            
                            <div class="flex w-full justify-between mt-2">
                                <div class="flex flex-col items-center w-1/2 border-r border-gray-200 pr-2">
                                    <div class="arrow-path w-full"></div>
                                    <div class="flowchart-rect bg-green-100 border-green-400" id="double-action-true">è²·å…¨ç¥¨ ($100)</div>
                                </div>
                                <div class="flex flex-col items-center w-1/2 pl-2">
                                    <div class="arrow-path w-full"></div>
                                    <div class="flowchart-rect bg-yellow-100 border-yellow-400" id="double-action-false">è²·å…’ç«¥ç¥¨ ($50)</div>
                                </div>
                            </div>
                            
                            <div class="flow-merge-point">
                                <div class="path-line-left" id="double-merge-left"></div>
                                <div class="path-line-right" id="double-merge-right"></div>
                                <div class="arrow-head">â†“</div>
                            </div>

                            <div class="flowchart-rect mt-[-20px]">çµæŸ</div>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <div class="bg-gray-900 rounded-lg p-4 text-gray-200 text-sm shadow-lg font-mono leading-relaxed">
                            <div class="text-gray-500"># ç¯„ä¾‹ï¼šé–€ç¥¨æª¢æŸ¥</div>
                            <div>age = <span id="code-double-val" class="text-purple-400">10</span></div>
                            <div id="line-double-1" class="pl-0 transition-colors duration-200">
                                <span class="text-pink-500">if</span> age >= <span class="text-orange-400">12</span>:
                            </div>
                            <div id="line-double-2" class="pl-4 transition-colors duration-200">
                                print(<span class="text-green-400">"å…¨ç¥¨"</span>)
                            </div>
                            <div id="line-double-3" class="pl-0 transition-colors duration-200">
                                <span class="text-pink-500">else</span>:
                            </div>
                            <div id="line-double-4" class="pl-4 transition-colors duration-200">
                                print(<span class="text-green-400">"å…’ç«¥ç¥¨"</span>)
                            </div>
                        </div>

                        <div class="bg-purple-50 p-6 rounded-lg border border-purple-100">
                            <label class="block text-sm font-bold text-gray-700 mb-2">è¼¸å…¥å¹´é½¡ï¼š</label>
                            <div class="flex items-center space-x-4">
                                <button onclick="changeAge(-1)" class="w-10 h-10 rounded-full bg-white border border-gray-300 flex items-center justify-center font-bold hover:bg-gray-100">-</button>
                                <span class="text-3xl font-bold text-purple-600 w-16 text-center" id="double-age-display">10</span>
                                <button onclick="changeAge(1)" class="w-10 h-10 rounded-full bg-white border border-gray-300 flex items-center justify-center font-bold hover:bg-gray-100">+</button>
                            </div>
                            <div class="mt-4 p-3 bg-white rounded border border-gray-200 text-center font-bold text-gray-700">
                                çµæœï¼š<span id="double-result-text">å…’ç«¥ç¥¨</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="content-multi" class="branch-content hidden">
                <div class="mb-6 border-l-4 border-emerald-500 pl-4">
                    <h3 class="text-xl font-bold text-gray-800">å¤šåˆ†æ”¯ (If-Elif-Else)</h3>
                    <p class="text-gray-600">æƒ…å¢ƒï¼šå¤šç¨®å¯èƒ½æ€§ (æˆç¸¾åˆ†ç´š)ã€‚ç¨‹å¼ç”±ä¸Šå¾€ä¸‹æª¢æŸ¥ï¼Œä¸€æ—¦æœ‰ä¸€å€‹æˆç«‹ï¼Œå°±è·³å‡ºã€‚ <span class="text-red-500 font-bold">(æ³¨æ„: åŠæ ¼åˆ†æ•¸ç¾ç‚º 50 åˆ†)</span></p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="flex flex-col items-center bg-stone-50 p-4 rounded-lg w-full">
                        <h4 class="font-bold text-gray-500 mb-2 text-sm tracking-wide w-full text-center">é‚è¼¯åˆ†ä½ˆåœ– (50åˆ†åŠæ ¼)</h4>
                        <p class="text-xs text-gray-500 mb-2 text-center">çœ‹ç¨‹å¼å¦‚ä½•å°‡é€£çºŒçš„åˆ†æ•¸ã€Œåˆ‡ã€æˆä¸åŒç­‰ç´š</p>
                        
                        <div class="chart-container">
                            <canvas id="multiBranchChart"></canvas>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <div class="bg-gray-900 rounded-lg p-4 text-gray-200 text-sm shadow-lg font-mono leading-relaxed">
                            <div class="text-gray-500"># ç¯„ä¾‹ï¼šæˆç¸¾è©•ç´š (90åˆ†å„ªç•°ï¼Œ50åˆ†åŠæ ¼)</div>
                            <div>score = <span id="code-multi-val" class="text-purple-400">75</span></div>
                            
                            <div id="line-multi-1" class="pl-0 transition-colors duration-200">
                                <span class="text-pink-500">if</span> score >= <span class="text-orange-400">90</span>:
                            </div>
                            <div id="line-multi-2" class="pl-4 transition-colors duration-200">
                                print(<span class="text-green-400">"å„ªç•° A"</span>)
                            </div>
                            
                            <div id="line-multi-3" class="pl-0 transition-colors duration-200">
                                <span class="text-pink-500">elif</span> score >= <span class="text-orange-400">50</span>:
                            </div>
                            <div id="line-multi-4" class="pl-4 transition-colors duration-200">
                                print(<span class="text-green-400">"åŠæ ¼ Pass"</span>)
                            </div>
                            
                            <div id="line-multi-5" class="pl-0 transition-colors duration-200">
                                <span class="text-pink-500">else</span>:
                            </div>
                            <div id="line-multi-6" class="pl-4 transition-colors duration-200">
                                print(<span class="text-green-400">"ä¸åŠæ ¼ Fail"</span>)
                            </div>
                        </div>

                        <div class="bg-emerald-50 p-6 rounded-lg border border-emerald-100">
                            <label class="block text-sm font-bold text-gray-700 mb-2">æ‹–å‹•åˆ†æ•¸æ»‘æ¡¿ï¼š</label>
                            <input type="range" min="0" max="100" value="75" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer mb-2 accent-emerald-600" id="multi-slider" oninput="updateMulti()">
                            <div class="flex justify-between items-center">
                                <span class="text-3xl font-bold text-emerald-600" id="multi-display">75</span>
                                <span class="px-4 py-2 bg-white rounded shadow text-lg font-bold border-l-4 border-yellow-400" id="multi-result-text">åŠæ ¼ Pass</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="max-w-4xl mx-auto mb-12">
        <h2 class="text-2xl font-bold text-gray-800 mb-6">4. å¯¦æˆ°æ¼”ç·´ (Challenge)</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            
            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="font-bold text-lg text-gray-700">æŒ‘æˆ° 1: éŠæ¨‚åœ’é–€ç¥¨</h3>
                    <span class="text-xs font-bold bg-blue-100 text-blue-600 px-2 py-1 rounded">é›™åˆ†æ”¯</span>
                </div>
                <p class="text-sm text-gray-600 mb-4">è«‹å®Œæˆä»£ç¢¼ï¼Œå¦‚æœå¹´é½¡å¤§æ–¼ç­‰æ–¼ 12 æ­²è²·å…¨ç¥¨ï¼Œå¦å‰‡è²·å…’ç«¥ç¥¨ã€‚</p>
                <div class="bg-gray-100 p-4 rounded text-sm font-mono mb-4">
                    age = int(input())<br>
                    if age <input type="text" id="quiz-1-op" class="quiz-input-field w-12" placeholder="?"> 12:<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;print("å…¨ç¥¨")<br>
                    <input type="text" id="quiz-1-kw" class="quiz-input-field w-16" placeholder="?">:<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;print("å…’ç«¥ç¥¨")
                </div>
                <button onclick="checkQuiz1()" class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition">æª¢æŸ¥ç­”æ¡ˆ</button>
                <p id="quiz-1-msg" class="mt-2 text-center text-sm font-bold min-h-[20px]"></p>
            </div>

            <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="font-bold text-lg text-gray-700">æŒ‘æˆ° 2: ä»£ç¢¼é‡æ§‹èˆ‡ç¸®æ’ç‰¹è¨“</h3>
                    <span class="text-xs font-bold bg-emerald-100 text-emerald-600 px-2 py-1 rounded">è‡ªç”±ç·¨è¼¯</span>
                </div>
                <p class="text-sm text-gray-600 mb-4">
                    è«‹åœ¨ä¸‹æ–¹ç·¨è¼¯å™¨ä¸­ï¼Œå®Œæˆ if-else èªå¥ï¼Œæ­£ç¢ºåˆ¤æ–·åˆ†æ•¸æ˜¯å¦åŠæ ¼ (>= 50)ã€‚<br>
                    <span class="text-red-500 font-bold">âš ï¸ æé†’ï¼šè«‹å‹™å¿…ä½¿ç”¨ã€Œ4 å€‹ç©ºæ ¼ã€é€²è¡Œç¸®æ’ï¼</span>
                </p>
                
                <textarea id="quiz-2-code-editor" rows="7" class="w-full bg-gray-900 text-green-400 p-3 rounded text-sm font-mono focus:outline-none focus:ring-2 focus:ring-emerald-500 resize-none" placeholder="score = 65 # ç¯„ä¾‹åˆ†æ•¸&#10;if ...&#10;    print(...)&#10;else:&#10;    print(...)">score = 65 # ç¯„ä¾‹åˆ†æ•¸
</textarea>
                
                <button onclick="checkQuiz2()" class="w-full bg-emerald-500 text-white py-2 rounded hover:bg-emerald-600 transition mt-4">æª¢æŸ¥ç­”æ¡ˆ</button>
                <p id="quiz-2-msg" class="mt-2 text-center text-sm font-bold min-h-[20px] whitespace-pre-line"></p>
            </div>
        </div>
    </section>

    <footer class="max-w-4xl mx-auto mb-12 text-center bg-stone-100 p-8 rounded-xl">
        <h2 class="text-xl font-bold text-gray-700 mb-4">æœ¬ç¯€ç¸½çµ</h2>
        <ul class="text-left inline-block space-y-2 text-gray-600">
            <li>âœ… <b>å‡ºè¡Œæ¨¡æ“¬å™¨</b>ï¼šé«”é©—æ¢ä»¶åˆ¤æ–·å¦‚ä½•å½±éŸ¿æœ€çµ‚çµæœã€‚</li>
            <li>âœ… <b>å¸ƒæ—å€¼ (Boolean)</b>ï¼šå­¸æœƒé›»è…¦å¦‚ä½•é€²è¡Œæ¯”è¼ƒä¸¦è¿”å› True/Falseã€‚</li>
            <li>âœ… <b>å–®åˆ†æ”¯ (if)</b>ï¼šåªæœ‰ä¸€æ¢è·¯ï¼Œç¬¦åˆæ‰èµ°ï¼Œä¸ç¬¦åˆå‰‡å³ç›´è·³éã€‚</li>
            <li>âœ… <b>é›™åˆ†æ”¯ (if-else)</b>ï¼šäºŒé¸ä¸€ï¼Œé A å³ Bã€‚</li>
            <li>âœ… <b>å¤šåˆ†æ”¯ (if-elif-else)</b>ï¼šå¤šé¸ä¸€ï¼Œç”±ä¸Šå¾€ä¸‹æª¢æŸ¥ï¼ŒåªåŸ·è¡Œç¬¬ä¸€å€‹ç¬¦åˆçš„å€å¡Šã€‚</li>
            <li>âš ï¸ <b>é‡è¦æé†’</b>ï¼šè¨˜å¾—ç¸®æ’ (Indentation) å’Œ å†’è™Ÿ (:)ï¼ä¸è¦ä½¿ç”¨å…¨å½¢æ¨™é»ç¬¦è™Ÿã€‚</li>
        </ul>
    </footer>

    <script>
        // =========================================================
        // 0. School Commute Simulator Logic (ä¸Šå­¸å‡ºè¡Œæ¨¡æ“¬å™¨)
        // =========================================================
        const LATE_TIME_MINUTES = 9 * 60 + 30; // 9:30 AM
        const START_TIME_MINUTES = 8 * 60 + 40; // 8:40 AM
        
        let currentTimeSim = START_TIME_MINUTES; // ç¸½åˆ†é˜æ•¸ (å¾åˆå¤œé–‹å§‹è¨ˆç®—)
        let currentStepSim = 1;
        let hasUmbrella = false;
        let isWeatherChecked = false;

        // æ¨¡æ“¬å™¨æ­¥é©Ÿå’Œé¸é …
        const stepsSim = [
            // Index 0: Placeholder
            { text: "", choices: [] },
            
            // Index 1: Step 1: æ—©ä¸Šèµ·åºŠ (8:40)
            { 
                text: "é¬§é˜éŸ¿èµ·ï¼Œç¾åœ¨æ˜¯æ—©ä¸Š 8 é» 40 åˆ†ã€‚ä½ æœƒé¸æ“‡ï¼š",
                choices: [
                    { label: "A. é¦¬ä¸Šèµ·åºŠ ğŸ§˜", time: 0 },
                    { label: "B. å†ç¡ 5 åˆ†é˜ ğŸ˜´", time: 5 }
                ]
            },
            
            // Index 2: Step 2: æ´—æ¼±æ›è¡£ (æ™‚é–“å·²æ›´æ–°: 10/30 åˆ†é˜)
            { 
                text: "èµ·åºŠå¾Œï¼Œä½ éœ€è¦æ•´ç†å„€å®¹ã€‚ä½ æœƒé¸æ“‡ï¼š",
                choices: [
                    { label: "A. ç°¡å–®æ´—æ¼±ã€æ›è¡£ ğŸš¿", time: 10 }, // UPDATED: 10 minutes
                    { label: "B. æ´—æ¼±ã€æ²–æ¶¼ã€æ´—é ­ã€å¹é ­ã€æ›è¡£ ğŸ›", time: 30 } // UPDATED: 30 minutes
                ]
            },

            // Index 3: Step 3: å¤©æ°£å ±å° (Conditional Gate)
            { 
                text: `æº–å‚™å‡ºé–€å‰ï¼Œä½ æ±ºå®šæŸ¥çœ‹ä¸€ä¸‹ä»Šå¤©çš„è³‡è¨Šã€‚ä½ æœƒé¸æ“‡ï¼š\n\nï¼ˆå¦‚æœæŸ¥çœ‹ï¼Œå ±å°æœƒå‘Šè¨´ä½ å¿«è¦ä¸‹é›¨ã€‚ï¼‰`,
                choices: [
                    { label: "A. æŸ¥çœ‹å¤©æ°£å ±å° ğŸ“°", time: 5, action: () => { isWeatherChecked = true; } },
                    { label: "B. ä¸çœ‹å¤©æ°£å ±å°ï¼Œç›´æ¥æº–å‚™å‡ºé–€ ğŸš€", time: 0, action: () => { isWeatherChecked = false; } }
                ]
            },

            // Index 4: Step 4 (Dynamic Umbrella Choice Placeholder) - This index is used for the dynamic step only.
            { text: "Dynamic Umbrella Decision Point", choices: [] },
            
            // Index 5: Step 5: é¸æ“‡äº¤é€šå·¥å…· (Final time addition - çš„å£«æ”¹ç‚ºèµ°è·¯)
            { 
                text: "ä¸€åˆ‡æº–å‚™å°±ç·’ï¼Œæ˜¯æ™‚å€™å‰å¾€å­¸æ ¡äº†ã€‚ä½ æœƒé¸æ“‡å“ªç¨®äº¤é€šå·¥å…·ï¼Ÿ",
                choices: [
                    { label: "A. å·´å£« ğŸšŒ", time: 30 },
                    { label: "B. é›»å–®è»Š ğŸï¸", time: 15 },
                    { label: "C. èµ°è·¯ ğŸš¶", time: 40 } // UPDATED: èµ°è·¯ 40 åˆ†é˜
                ]
            }
        ];

        // HTML å…ƒç´  (Simulator)
        let timeDisplaySimEl;
        let scenarioTextSimEl;
        let choiceButtonsSimEl;
        let simulatorAppEl;
        let weatherStatusEl, umbrellaStatusEl, stateStatusEl; // NEW Status Elements

        // å‡½å¼: æ™‚é–“æ ¼å¼åŒ–
        function formatTime(totalMinutes) {
            const hours = Math.floor(totalMinutes / 60) % 24;
            const minutes = totalMinutes % 60;
            return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(0, '0')}`;
        }

        // å‡½å¼: æ›´æ–°ç‹€æ…‹é¢æ¿ (NEW)
        function updateStatusPanelSim(step) {
            if (!weatherStatusEl || !umbrellaStatusEl || !stateStatusEl) return;

            // 1. Weather Status - åªæœ‰åœ¨ Step 3 åšå‡ºé¸æ“‡ä¹‹å¾Œ (å³ step >= 4) æ‰é¡¯ç¤ºéå•è™Ÿç‹€æ…‹
            if (step >= 4) {
                if (isWeatherChecked) {
                    // å·²æŸ¥çœ‹å ±å°
                    weatherStatusEl.innerHTML = `<span class="text-2xl">ğŸŒ¦ï¸</span><br>å·²çŸ¥: å¿«ä¸‹é›¨`;
                    weatherStatusEl.className = 'status-box bg-orange-100 text-orange-800 transition duration-300';
                } else {
                    // æœªæŸ¥çœ‹å ±å° - ä¿æŒæœªçŸ¥ç‹€æ…‹ (æ ¹æ“šç”¨æˆ¶è¦æ±‚ç§»é™¤ã€ŒæœªçŸ¥: æ™´å¤©ã€çš„æ¨æ¸¬)
                    weatherStatusEl.innerHTML = `<span class="text-2xl">â“</span><br>æœªçŸ¥`;
                    weatherStatusEl.className = 'status-box bg-gray-100 text-gray-800 transition duration-300';
                }
            } else {
                // Initial state (Step 1, 2, 3) - ä¿æŒåˆå§‹ä¸­æ€§ç‹€æ…‹
                weatherStatusEl.innerHTML = `<span class="text-2xl">â“</span><br>å¤©æ°£ç‹€æ…‹`;
                weatherStatusEl.className = 'status-box bg-gray-100 text-gray-800 transition duration-300';
            }
            
            // 2. Umbrella Status - åªæœ‰åœ¨æœ‰å¸¶å‚˜æ™‚æ‰æ˜ç¢ºé¡¯ç¤ºç‹€æ…‹
            if (hasUmbrella) {
                umbrellaStatusEl.innerHTML = `<span class="text-2xl">âœ… â˜”</span><br>å·²å¸¶å‚˜`;
                umbrellaStatusEl.className = 'status-box bg-green-100 text-green-800 transition duration-300';
            } else {
                // æœªå¸¶å‚˜æ™‚ï¼Œé¡¯ç¤ºä¸­æ€§/å•è™Ÿç‹€æ…‹
                umbrellaStatusEl.innerHTML = `<span class="text-2xl">â“</span><br>é›¨å‚˜ç‹€æ…‹`;
                umbrellaStatusEl.className = 'status-box bg-gray-100 text-gray-800 transition duration-300';
            }

            // 3. State Status (Based on current time relative to late time)
            let icon, text, color;

            if (currentTimeSim >= LATE_TIME_MINUTES) {
                icon = 'ğŸ›‘'; text = 'å·²é²åˆ°'; color = 'bg-red-200 text-red-900';
            } else if (currentTimeSim >= LATE_TIME_MINUTES - 15) { // Within 15 minutes of being late
                icon = 'ğŸ’¨'; text = 'å¿«é²åˆ°ï¼'; color = 'bg-red-100 text-red-800';
            } else if (currentTimeSim >= START_TIME_MINUTES + 20) { // Used more than 20 mins
                icon = 'ğŸš¶'; text = 'è¶•æ™‚é–“'; color = 'bg-yellow-100 text-yellow-800';
            } else {
                icon = 'ğŸ§˜'; text = 'æ‚ é–’ä¸­'; color = 'bg-green-100 text-green-800';
            }
            stateStatusEl.innerHTML = `<span class="text-2xl">${icon}</span><br>${text}`;
            stateStatusEl.className = 'status-box ' + color + ' transition duration-300';
        }

        // å‡½å¼: æ›´æ–° UI
        function updateSimUI() {
            if (!timeDisplaySimEl) return; // Guard clause for initialization

            timeDisplaySimEl.textContent = formatTime(currentTimeSim);
            updateStatusPanelSim(currentStepSim); // Always update panel

            // ç•¶ currentStepSim å¤§æ–¼é™£åˆ—æœ€å¤§ç´¢å¼• (5) æ™‚ï¼ŒéŠæˆ²çµæŸ
            if (currentStepSim > stepsSim.length - 1) { 
                showResultSim();
                return;
            }

            const step = stepsSim[currentStepSim];
            scenarioTextSimEl.textContent = step.text;
            choiceButtonsSimEl.innerHTML = ''; // æ¸…ç©ºæŒ‰éˆ•

            // æ¸²æŸ“é¸é …æŒ‰éˆ•
            step.choices.forEach(choice => {
                const button = document.createElement('button');
                button.textContent = choice.label;
                // Add a subtle scale effect on hover for better feel
                button.className = 'w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-4 rounded-lg transition duration-150 ease-in-out shadow-md hover:shadow-lg transform hover:scale-[1.01]';
                button.onclick = () => nextStepSim(choice.time, choice.action);
                choiceButtonsSimEl.appendChild(button);
            });
        }
        
        // å‡½å¼: è™•ç†ä¸‹ä¸€æ­¥é©Ÿ (æ–°å¢æ™‚é–“æµé€çš„è¦–è¦ºè„ˆè¡)
        function nextStepSim(timeSpent, action = null) {
            // è¦–è¦ºè„ˆè¡ï¼šå¼·èª¿æ™‚é–“çš„æµé€
            if (timeSpent > 0) {
                simulatorAppEl.classList.add('animate-pulse-time');
                setTimeout(() => {
                    simulatorAppEl.classList.remove('animate-pulse-time');
                }, 500);
            }

            // 1. åŸ·è¡Œå‹•ä½œ (ä¾‹å¦‚è¨­å®š isWeatherChecked)
            if (action) {
                action();
            }

            // 2. æ›´æ–°æ™‚é–“
            currentTimeSim += timeSpent;
            
            // 3. è™•ç†ç‰¹æ®Šçš„æ­¥é©Ÿæµç¨‹ (æ¢ä»¶èªå¥çš„æ ¸å¿ƒæ‡‰ç”¨ - è®“æµç¨‹è·³éæˆ–åŠ å…¥ Step 4)
            if (currentStepSim === 3) {
                // Step 3 (å¤©æ°£æª¢æŸ¥) çµæŸ
                if (isWeatherChecked) {
                    // çœ‹éå ±å°ï¼Œé€²å…¥ Dynamic Step 4: å¸¶å‚˜é¸æ“‡ (Index 4)
                    currentStepSim = 4;
                    showUmbrellaChoice();
                } else {
                    // æ²’çœ‹å ±å°ï¼Œè·³é Dynamic Step 4ï¼Œç›´æ¥é€²å…¥ Step 5: äº¤é€šå·¥å…· (Index 5)
                    currentStepSim = 5;
                    updateSimUI(); 
                }
                return; // æµç¨‹å·²ç¶“è¢«ç‰¹æ®Šè™•ç†ï¼Œè·³éè‡ªå‹•éå¢ currentStepSim

            } else if (currentStepSim === 4) {
                // Step 4 (å¸¶å‚˜é¸æ“‡) çµæŸï¼Œç„¡è«–æœ‰ç„¡å¸¶å‚˜ï¼Œä¸‹ä¸€æ­¥éƒ½é€²å…¥ Step 5: äº¤é€šå·¥å…· (Index 5)
                currentStepSim = 5;
                updateSimUI();
                return; // æµç¨‹å·²ç¶“è¢«ç‰¹æ®Šè™•ç†ï¼Œè·³éè‡ªå‹•éå¢ currentStepSim
            }

            // 4. æ­£å¸¸æ¨é€²æ­¥é©Ÿ (ç•¶å‰ç‚º Step 1, 2)
            currentStepSim++;
            updateSimUI();
        }

        // å‡½å¼: é¡¯ç¤ºå¸¶å‚˜é¸æ“‡ (Step 4 - å‹•æ…‹ç”Ÿæˆï¼Œå› ç‚º stepsSim[4] åªæ˜¯å€‹ä½”ä½ç¬¦)
        function showUmbrellaChoice() {
            scenarioTextSimEl.textContent = `ä½ çœ‹äº†å¤©æ°£å ±å°ï¼Œå¾—çŸ¥å¿«è¦ä¸‹é›¨äº†ã€‚é€™æ˜¯ä½ çš„ **æ¢ä»¶åˆ¤æ–·é» (Conditional Gate)**ï¼ä½ æœƒé¸æ“‡ï¼š`;
            choiceButtonsSimEl.innerHTML = '';
            
            // å¸¶å‚˜é¸é … (è¨­ç½® hasUmbrella = true)
            const bringButton = document.createElement('button');
            bringButton.textContent = "A. å¸¶ä¸Šé›¨å‚˜ (0 åˆ†é˜) â˜”";
            bringButton.className = 'w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-4 rounded-lg transition duration-150 ease-in-out shadow-md hover:shadow-lg transform hover:scale-[1.01]';
            bringButton.onclick = () => {
                hasUmbrella = true;
                nextStepSim(0); 
            };
            choiceButtonsSimEl.appendChild(bringButton);

            // ä¸å¸¶å‚˜é¸é … (è¨­ç½® hasUmbrella = false)
            const skipButton = document.createElement('button');
            skipButton.textContent = "B. ä¸å¸¶é›¨å‚˜ (0 åˆ†é˜) ğŸ™…â€â™‚ï¸";
            // ç”±æ–¼ç”¨æˆ¶è¦æ±‚æœªå¸¶å‚˜ä¸é¡¯ç¤ºæ˜ç¢ºçš„éŒ¯èª¤ç‹€æ…‹ï¼Œé€™è£¡ä½¿ç”¨ä¸€å€‹ä¸­æ€§ä½†æœ‰æš—ç¤ºçš„é¡è‰²
            skipButton.className = 'w-full bg-yellow-600 hover:bg-yellow-700 text-white font-semibold py-3 px-4 rounded-lg transition duration-150 ease-in-out shadow-md hover:shadow-lg transform hover:scale-[1.01]';
            skipButton.onclick = () => {
                hasUmbrella = false;
                nextStepSim(0); 
            };
            choiceButtonsSimEl.appendChild(skipButton);
        }

        // å‡½å¼: é¡¯ç¤ºçµæœ (å¼·åŒ–æ·‹æ¿•æ¢ä»¶)
        function showResultSim() {
            const isLate = currentTimeSim > LATE_TIME_MINUTES; // 9:30 AM åˆ¤æ–·æ˜¯å¦é²åˆ°
            const arrivalTime = formatTime(currentTimeSim);
            
            let resultTitle = "";
            let resultMessage = "";
            let resultColor = "";
            let rainStatusIcon = "";

            // æ ¸å¿ƒæ¢ä»¶åˆ¤æ–· (if-elif-else é‚è¼¯)
            // ç•¶ isWeatherChecked=false (æ²’çœ‹å ±å°)ï¼Œä½† isLate=false (æº–æ™‚) ä¸” hasUmbrella=false (æ²’å¸¶å‚˜)
            // æµç¨‹èµ°åˆ°é€™ä¸€æ­¥æ™‚ï¼Œå¦‚æœ isWeatherChecked=falseï¼Œå‰‡ hasUmbrella å¿…ç„¶æ˜¯ falseï¼Œå› ç‚ºæ²’çœ‹å ±å°ç›´æ¥è·³éäº†å¸¶å‚˜çš„æ­¥é©Ÿã€‚
            if (!isLate && hasUmbrella) {
                // å¥½çµå±€: æº–æ™‚ AND æœ‰å¸¶å‚˜
                resultTitle = "ã€å¥½çµå±€ã€‘â˜€ï¸ æº–æ™‚ä¸”æœ‰æº–å‚™ï¼";
                resultMessage = `ä½ æ–¼ ${arrivalTime} åˆ°é”å­¸æ ¡ï¼Œæ²’æœ‰é²åˆ°ã€‚ä½ æŸ¥çœ‹äº†å¤©æ°£ä¸¦å¸¶äº†å‚˜ï¼Œåœ¨é›¨ä¸­ä¿æŒäº†ä¹¾çˆ½ã€‚å®Œç¾çš„ä¸€å¤©ï¼`;
                resultColor = "bg-green-100 border-green-500 text-green-700";
                rainStatusIcon = "âœ… ä¹¾çˆ½ç„¡è™";
            } else if (!isLate && !hasUmbrella) {
                // æ™®é€šçµå±€: æº–æ™‚ AND æ²’å¸¶å‚˜ (å…¨èº«æ¿•é€ä½†æ˜¯æ²’é²åˆ°)
                resultTitle = "ã€æ™®é€šçµå±€ã€‘ğŸŒ§ï¸ æº–æ™‚ä½†å…¨èº«æ¿•é€äº†ï¼";
                resultMessage = `ä½ æ–¼ ${arrivalTime} åˆ°é”å­¸æ ¡ï¼Œæ²’æœ‰é²åˆ°ã€‚å¯æƒœä½ æ²’æœ‰å¸¶å‚˜ï¼Œåˆ°é”æ™‚å…¨èº«æ¿•é€ï¼Œä½†è‡³å°‘ä½ è¶•ä¸Šäº†ã€‚`;
                resultColor = "bg-yellow-100 border-yellow-500 text-yellow-700";
                rainStatusIcon = "âŒ å…¨èº«æ¿•é€";
            } else if (isLate && !hasUmbrella) {
                // å£çµå±€: é²åˆ° AND æ²’å¸¶å‚˜ (é²åˆ°åˆå…¨èº«æ¿•é€äº†)
                resultTitle = "ã€å£çµå±€ã€‘ğŸš¨ é²åˆ°åˆå…¨èº«æ¿•é€äº†ï¼";
                resultMessage = `ä½ æ–¼ ${arrivalTime} åˆ°é”å­¸æ ¡ï¼Œå·²ç¶“é²åˆ°ï¼æ›´ç³Ÿçš„æ˜¯ï¼Œä½ æ²’æœ‰å¸¶å‚˜ï¼Œå…¨èº«æ¿•é€ï¼Œé‚„å¾—è¢«è¨“å°ä¸»ä»»ç½µã€‚ç³Ÿé€äº†ï¼`;
                resultColor = "bg-red-100 border-red-500 text-red-700";
                rainStatusIcon = "âŒ å…¨èº«æ¿•é€";
            } else { // isLate && hasUmbrella
                // ä¸­æ€§çµå±€: é²åˆ° AND æœ‰å¸¶å‚˜
                resultTitle = "ã€é²åˆ°çµå±€ã€‘â˜” é›–ç„¶é²åˆ°ä½†ä¿æŒä¹¾çˆ½ã€‚";
                resultMessage = `ä½ æ–¼ ${arrivalTime} åˆ°é”å­¸æ ¡ï¼Œå·²ç¶“é²åˆ°ï¼å¹¸å¥½ä½ å¸¶äº†å‚˜ï¼Œæ²’æœ‰æ·‹æ¿•ã€‚é›–ç„¶ä¹¾çˆ½ï¼Œä½†ä½ éŒ¯éäº†æ—©ä¸Šçš„é‡è¦èª²å ‚ã€‚`;
                resultColor = "bg-blue-100 border-blue-500 text-blue-700";
                rainStatusIcon = "âœ… ä¹¾çˆ½ç„¡è™";
            }

            // æ¸²æŸ“çµæœé é¢
            simulatorAppEl.innerHTML = `
                <div class="flex flex-col items-center text-center">
                    <h1 class="text-3xl font-extrabold text-gray-900 mb-6">æ¨¡æ“¬çµæŸï¼</h1>
                    
                    <div class="w-full p-6 border-4 rounded-xl ${resultColor} mb-6">
                        <p class="text-2xl font-bold mb-3">${resultTitle}</p>
                        <p class="text-lg">${resultMessage}</p>
                    </div>

                    <div class="flex space-x-8 text-center mb-8">
                        <div class="p-3 bg-white rounded-lg shadow-inner border border-gray-200">
                            <p class="text-lg text-gray-700">æœ€çµ‚æ™‚é–“</p>
                            <span class="font-bold text-3xl text-indigo-600">${arrivalTime}</span>
                            <p class="text-sm text-gray-500">${isLate ? '(é²åˆ°)' : '(æº–æ™‚)'}</p>
                        </div>
                        <div class="p-3 bg-white rounded-lg shadow-inner border border-gray-200">
                            <p class="text-lg text-gray-700">æ·‹é›¨ç‹€æ…‹</p>
                            <span class="font-bold text-3xl text-emerald-600">${rainStatusIcon}</span>
                            <p class="text-sm text-gray-500">${hasUmbrella ? 'æœ‰å¸¶å‚˜' : 'æ²’å¸¶å‚˜'}</p>
                        </div>
                    </div>


                    <button onclick="restartGameSim()" class="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-8 rounded-full transition duration-150 ease-in-out shadow-lg hover:shadow-xl">
                        ğŸ”„ é‡æ–°é–‹å§‹æ¨¡æ“¬
                    </button>
                </div>
            `;
        }
        
        // å‡½å¼: é‡æ–°é–‹å§‹
        function restartGameSim() {
            currentTimeSim = START_TIME_MINUTES;
            currentStepSim = 1;
            hasUmbrella = false;
            isWeatherChecked = false;
            
            // Reset the HTML structure back to the game state (Keep the status panel) - ç¢ºä¿åˆå§‹ç‹€æ…‹ç¬¦åˆç”¨æˆ¶è¦æ±‚
            simulatorAppEl.innerHTML = `
                <div class="flex justify-between items-center mb-6">
                    <div class="time-display-sim">
                        â° æ™‚é–“: <span id="current-time-sim">08:40</span>
                    </div>
                    <h1 class="text-xl font-bold text-gray-800">ğŸš¦ æ±ºç­–ä¸­...</h1>
                </div>

                <div class="flex flex-wrap justify-center gap-4 mb-8 text-center">
                    <div id="weather-status-sim" class="status-box bg-gray-100 text-gray-800 transition duration-300">
                        <span class="text-2xl">â“</span><br>å¤©æ°£ç‹€æ…‹
                    </div>
                    <div id="umbrella-status-sim" class="status-box bg-gray-100 text-gray-800 transition duration-300">
                        <span class="text-2xl">â“</span><br>é›¨å‚˜ç‹€æ…‹
                    </div>
                    <div id="state-status-sim" class="status-box bg-yellow-100 text-yellow-800 transition duration-300">
                        <span class="text-2xl">ğŸƒ</span><br>å€‹äººç‹€æ…‹
                    </div>
                </div>

                <div id="game-content-sim">
                    <p id="scenario-text-sim" class="text-lg mb-8 text-gray-700 leading-relaxed"></p>
                    <div id="choice-buttons-sim" class="space-y-4"></div>
                </div>
            `;
            // Re-assign elements after innerHTML reset (CRITICAL)
            timeDisplaySimEl = document.getElementById('current-time-sim');
            scenarioTextSimEl = document.getElementById('scenario-text-sim');
            choiceButtonsSimEl = document.getElementById('choice-buttons-sim');
            simulatorAppEl = document.getElementById('simulator-app');
            // Re-assign new status elements
            weatherStatusEl = document.getElementById('weather-status-sim');
            umbrellaStatusEl = document.getElementById('umbrella-status-sim');
            stateStatusEl = document.getElementById('state-status-sim');

            updateSimUI();
        }

        // å•Ÿå‹•éŠæˆ²
        function startSimulator() {
            // Initial element assignment
            timeDisplaySimEl = document.getElementById('current-time-sim');
            scenarioTextSimEl = document.getElementById('scenario-text-sim');
            choiceButtonsSimEl = document.getElementById('choice-buttons-sim');
            simulatorAppEl = document.getElementById('simulator-app');
            // Initial status elements assignment
            weatherStatusEl = document.getElementById('weather-status-sim');
            umbrellaStatusEl = document.getElementById('umbrella-status-sim');
            stateStatusEl = document.getElementById('state-status-sim');
            
            updateSimUI();
        }

        // =========================================================
        // 1. Boolean Logic
        // =========================================================
        function checkBoolean() {
            const n1Raw = document.getElementById('bool-num1').value.trim();
            const n2Raw = document.getElementById('bool-num2').value.trim();
            
            const n1 = (n1Raw !== '' && !isNaN(n1Raw) && isFinite(n1Raw)) ? Number(n1Raw) : n1Raw;
            const n2 = (n2Raw !== '' && !isNaN(n2Raw) && isFinite(n2Raw)) ? Number(n2Raw) : n2Raw;

            const op = document.getElementById('bool-op').value;
            let res = false;
            
            try {
                if (op === '>') res = n1 > n2;
                else if (op === '<') res = n1 < n2;
                else if (op === '==') res = n1 == n2; 
                else if (op === '!=') res = n1 != n2;
                else if (op === '>=') res = n1 >= n2;
                else if (op === '<=') res = n1 <= n2;
                else res = false;
            } catch (e) {
                console.error("Comparison error:", e);
                res = "Error";
            }

            const resEl = document.getElementById('bool-result');
            if (res === "Error") {
                resEl.innerText = "Error";
                resEl.className = "text-3xl font-mono font-bold text-gray-500";
            } else {
                resEl.innerText = res ? "True" : "False";
                resEl.className = res ? "text-3xl font-mono font-bold text-green-400" : "text-3xl font-mono font-bold text-red-500";
            }
        }

        // =========================================================
        // 2. Rain Introduction Logic
        // =========================================================
        function toggleRain(isRaining) {
            const feedback = document.getElementById('rain-feedback');
            const text = document.getElementById('rain-text');
            
            if (isRaining) {
                feedback.innerText = "â˜”";
                text.innerText = "ä¸‹é›¨äº†ï¼åŸ·è¡Œå‹•ä½œï¼šå¸¶é›¨å‚˜ã€‚";
                text.className = "font-bold text-xl text-blue-600";
            } else {
                feedback.innerText = "ğŸƒ";
                text.innerText = "æ²’ä¸‹é›¨ï¼åŸ·è¡Œå‹•ä½œï¼šç›´æ¥å‡ºé–€ã€‚";
                text.className = "font-bold text-xl text-orange-600";
            }
        }

        // =========================================================
        // 3. Syntax Workshop Logic
        // =========================================================
        function switchTab(tab) {
            // Hide all contents
            ['single', 'double', 'multi'].forEach(t => {
                document.getElementById('content-' + t).classList.add('hidden');
                document.getElementById('tab-' + t).classList.remove('bg-blue-600', 'text-white');
                document.getElementById('tab-' + t).classList.add('bg-white', 'text-gray-600');
            });
            
            // Show selected
            document.getElementById('content-' + tab).classList.remove('hidden');
            document.getElementById('tab-' + tab).classList.remove('bg-white', 'text-gray-600');
            document.getElementById('tab-' + tab).classList.add('bg-blue-600', 'text-white');

            // Resize charts if needed
            if(tab === 'multi' && window.multiChart) {
                window.multiChart.resize();
            }
        }

        // Helper function to reset and set classes for flowchart
        function resetFlowchartStyles(diamond, actionTrue, actionFalse, mergeLeft, mergeRight) {
            // Reset Diamond
            diamond.style.backgroundColor = '#fffbeb'; // Default color
            diamond.style.borderColor = '#d97706'; // Default border
            diamond.classList.remove('true-path');

            // Reset True Action
            actionTrue.style.opacity = '0.3';
            actionTrue.classList.remove('true-action');
            actionTrue.classList.remove('bg-green-300', 'border-green-600', 'font-bold');
            actionTrue.classList.add('bg-green-100', 'border-green-400');

            // Reset False Action (Double only)
            if (actionFalse) {
                actionFalse.style.opacity = '0.3';
                actionFalse.classList.remove('bg-yellow-300', 'border-yellow-600', 'font-bold');
                actionFalse.classList.add('bg-yellow-100', 'border-yellow-400');
            }

            // Reset Merge Lines
            if (mergeLeft) mergeLeft.style.borderColor = '#9ca3af'; // Gray
            if (mergeRight) mergeRight.style.borderColor = '#9ca3af'; // Gray
        }

        // 3a. Single Branch Logic (åˆæ ¼åˆ†æ•¸: 50)
        const PASS_SCORE_SINGLE = 50;
        function updateSingle() {
            const score = parseInt(document.getElementById('single-slider').value);
            document.getElementById('single-display').innerText = score;
            document.getElementById('code-single-val').innerText = score;
            document.getElementById('line-single-1').innerHTML = `<span class="text-pink-500">if</span> score >= <span class="text-orange-400">${PASS_SCORE_SINGLE}</span>:`;

            const status = document.getElementById('single-status');
            const diamond = document.getElementById('single-diamond');
            const action = document.getElementById('single-action');
            const mergeLeft = document.getElementById('single-merge-left');
            const mergeRight = document.getElementById('single-merge-right');

            const line1 = document.getElementById('line-single-1');
            const line2 = document.getElementById('line-single-2');
            
            // Reset styles
            [line1, line2].forEach(l => l.classList.remove('highlight-line'));
            resetFlowchartStyles(diamond, action, null, mergeLeft, mergeRight);

            // Simulate logic execution
            line1.classList.add('highlight-line');
            
            if (score >= PASS_SCORE_SINGLE) {
                status.innerText = "åŠæ ¼ (Pass)";
                status.className = "px-3 py-1 bg-green-100 text-green-700 rounded shadow text-sm font-bold";
                
                // TRUE PATH VISUAL ENHANCEMENT
                diamond.classList.add('true-path');
                action.classList.add('true-action');
                
                mergeLeft.style.borderColor = '#059669'; // Highlight merge path
                mergeRight.style.borderColor = '#9ca3af'; // Gray
                
                setTimeout(() => line2.classList.add('highlight-line'), 100);
            } else {
                status.innerText = "ä¸åŠæ ¼ (ç„¡å‹•ä½œ)";
                status.className = "px-3 py-1 bg-red-100 text-red-700 rounded shadow text-sm font-bold";
                
                // FALSE PATH VISUAL ENHANCEMENT
                diamond.style.backgroundColor = '#f87171'; // Red 400
                diamond.style.borderColor = '#dc2626'; // Red 600

                mergeLeft.style.borderColor = '#9ca3af'; // Gray
                mergeRight.style.borderColor = '#dc2626'; // Highlight skip path (Right side)
            }
        }

        // 3b. Double Branch Logic
        let currentAge = 10;
        function changeAge(delta) {
            currentAge += delta;
            if (currentAge < 0) currentAge = 0;
            document.getElementById('double-age-display').innerText = currentAge;
            document.getElementById('code-double-val').innerText = currentAge;
            updateDouble();
        }
        function updateDouble() {
            const resText = document.getElementById('double-result-text');
            const diamond = document.getElementById('double-diamond');
            const actionTrue = document.getElementById('double-action-true');
            const actionFalse = document.getElementById('double-action-false');
            const mergeLeft = document.getElementById('double-merge-left');
            const mergeRight = document.getElementById('double-merge-right');

            const l1 = document.getElementById('line-double-1');
            const l2 = document.getElementById('line-double-2');
            const l3 = document.getElementById('line-double-3');
            const l4 = document.getElementById('line-double-4');
            
            // Reset styles
            [l1,l2,l3,l4].forEach(l => l.classList.remove('highlight-line'));
            resetFlowchartStyles(diamond, actionTrue, actionFalse, mergeLeft, mergeRight);

            l1.classList.add('highlight-line');

            if (currentAge >= 12) {
                resText.innerText = "å…¨ç¥¨ ($100)";
                resText.className = "font-bold text-green-600";
                
                // TRUE PATH VISUAL ENHANCEMENT
                diamond.classList.add('true-path');
                actionTrue.classList.add('true-action');
                
                mergeLeft.style.borderColor = '#059669'; // Highlight merge path

                setTimeout(() => l2.classList.add('highlight-line'), 100);
            } else {
                resText.innerText = "å…’ç«¥ç¥¨ ($50)";
                resText.className = "font-bold text-yellow-600";
                
                // FALSE PATH VISUAL ENHANCEMENT
                diamond.style.backgroundColor = '#f87171'; // Red 400
                diamond.style.borderColor = '#dc2626'; // Red 600

                actionFalse.style.opacity = '1';
                actionFalse.classList.remove('bg-yellow-100', 'border-yellow-400');
                actionFalse.classList.add('bg-yellow-300', 'border-yellow-600', 'font-bold'); // Bolder action box
                
                mergeRight.style.borderColor = '#dc2626'; // Highlight merge path

                setTimeout(() => l3.classList.add('highlight-line'), 100);
                setTimeout(() => l4.classList.add('highlight-line'), 200);
            }
        }

        // 3c. Multi Branch Logic & Chart (åˆæ ¼åˆ†æ•¸: 50)
        const PASS_SCORE_MULTI = 50;
        const EXCELLENT_SCORE_MULTI = 90;

        let multiChart;
        function initMultiChart() {
            const ctx = document.getElementById('multiBranchChart').getContext('2d');
            
            const dataPoints = [];
            for (let i = 0; i <= 100; i++) {
                let gradeVal = 0;
                if (i >= EXCELLENT_SCORE_MULTI) gradeVal = 2;
                else if (i >= PASS_SCORE_MULTI) gradeVal = 1;
                else gradeVal = 0;
                dataPoints.push({x: i, y: gradeVal});
            }

            multiChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [
                        {
                            label: 'ç­‰ç´šéšæ¢¯',
                            data: dataPoints,
                            borderColor: '#10b981',
                            borderWidth: 2,
                            stepped: true,
                            pointRadius: 0,
                            fill: true,
                            backgroundColor: 'rgba(16, 185, 129, 0.1)'
                        },
                        {
                            label: 'ä½ çš„åˆ†æ•¸',
                            data: [{x: 75, y: 1}],
                            backgroundColor: '#d97706',
                            borderColor: '#fff',
                            borderWidth: 2,
                            pointRadius: 8,
                            type: 'scatter'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'linear',
                            min: 0,
                            max: 100,
                            title: { display: true, text: 'åˆ†æ•¸ (Score)' }
                        },
                        y: {
                            min: -0.5,
                            max: 2.5,
                            ticks: {
                                callback: function(value) {
                                    if(value === 0) return 'ä¸åŠæ ¼ Fail';
                                    if(value === 1) return 'åŠæ ¼ Pass';
                                    if(value === 2) return 'å„ªç•° A';
                                    return '';
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    }
                }
            });
        }

        function updateMulti() {
            const score = parseInt(document.getElementById('multi-slider').value);
            document.getElementById('multi-display').innerText = score;
            document.getElementById('code-multi-val').innerText = score;
            document.getElementById('line-multi-3').innerHTML = `<span class="text-pink-500">elif</span> score >= <span class="text-orange-400">${PASS_SCORE_MULTI}</span>:`;

            const resText = document.getElementById('multi-result-text');
            
            for(let i=1; i<=6; i++) document.getElementById(`line-multi-${i}`).classList.remove('highlight-line');

            let gradeY = 0;
            let delay = 100;
            const highlight = (lineNumber) => {
                setTimeout(() => {
                    document.getElementById(`line-multi-${lineNumber}`).classList.add('highlight-line');
                }, delay);
                delay += 100;
            };
            
            document.getElementById('line-multi-1').classList.add('highlight-line');

            if (score >= EXCELLENT_SCORE_MULTI) {
                resText.innerText = "å„ªç•° (A)";
                resText.style.borderColor = "#10b981";
                highlight(2);
                gradeY = 2;
            } else {
                highlight(3);
                
                if (score >= PASS_SCORE_MULTI) {
                    resText.innerText = "åŠæ ¼ (Pass)";
                    resText.style.borderColor = "#f59e0b";
                    highlight(4);
                    gradeY = 1;
                } else {
                    highlight(5);
                    resText.innerText = "ä¸åŠæ ¼ (Fail)";
                    resText.style.borderColor = "#ef4444";
                    highlight(6);
                    gradeY = 0;
                }
            }

            if (multiChart) {
                multiChart.data.datasets[1].data = [{x: score, y: gradeY}];
                multiChart.update('none');
            }
        }

        // =========================================================
        // 4. Quiz Logic
        // =========================================================
        function checkQuiz1() {
            const op = document.getElementById('quiz-1-op').value.trim();
            const kw = document.getElementById('quiz-1-kw').value.trim();
            const msg = document.getElementById('quiz-1-msg');

            // Accept >= or =>
            const opCorrect = (op === '>=' || op === '=>');
            // Accept else 
            const kwCorrect = (kw.toLowerCase() === 'else');

            if (opCorrect && kwCorrect) {
                msg.innerText = "âœ… æ­£ç¢ºï¼ä½ å¾ˆæ£’ï¼";
                msg.className = "mt-2 text-center text-sm font-bold text-green-600";
            } else {
                msg.innerText = "âŒ è©¦è©¦çœ‹ï¼šé‹ç®—ç¬¦è™Ÿæ˜¯ >=ï¼Œç¬¬äºŒå€‹é—œéµå­—æ˜¯ else";
                msg.className = "mt-2 text-center text-sm font-bold text-red-500";
            }
        }
        
        // Challenge 2 Logic (UPDATED TO TEXTAREA CHECKING)
        function checkQuiz2() {
            // 1. Get the entire text content
            const code = document.getElementById('quiz-2-code-editor').value;
            const msg = document.getElementById('quiz-2-msg');

            // 2. Define expected patterns (ignore leading/trailing whitespace, but preserve internal 4-space indent)
            const expectedLines = [
                'if score >= 50:',
                '    print("åŠæ ¼ Pass")',
                'else:',
                '    print("ä¸åŠæ ¼ Fail")'
            ];
            
            // 3. Normalize and filter the code lines (remove comments, trim blank lines)
            const lines = code.split('\n')
                                  .map(line => {
                                      // Only remove comments from the end
                                      const cleanLine = line.split('#')[0].trimEnd();
                                      // Preserve leading spaces if they are not followed by only whitespace
                                      return cleanLine;
                                  })
                                  // Filter out empty lines and the initial score definition (which starts with 'score =')
                                  .filter(line => line.trim().length > 0 && !line.trim().startsWith('score =')); 
                                  
            
            let isCorrect = true;
            let hint = "";
            
            if (lines.length < 4) {
                isCorrect = false;
                hint = "âŒ ä»£ç¢¼è¡Œæ•¸ä¸è¶³ï¼Œè«‹ç¢ºä¿å¯«å‡ºå®Œæ•´çš„ if-else çµæ§‹ (è‡³å°‘åŒ…å« if, ç¸®æ’ print, else, ç¸®æ’ print)ã€‚";
            } else {
                // Check if the lines match the exact expected content, including indentation
                // We will look for lines containing the expected pattern to allow for user-added blank lines

                // 1. Check IF line: Should be at the start of a line (no leading spaces)
                const ifLine = lines.find(l => l.trim().startsWith('if'));
                if (!ifLine || ifLine.trim() !== expectedLines[0].trim()) {
                     isCorrect = false;
                     hint = "âŒ æ¢ä»¶åˆ¤æ–·è¡Œ (if) èªæ³•éŒ¯èª¤æˆ–æ¢ä»¶ä¸å°ï¼Œæ­£ç¢ºæ‡‰ç‚ºï¼šif score >= 50:";
                }

                // 2. Check first action line (needs 4 spaces prefix)
                const printPassLine = lines.find(l => l.includes('print("åŠæ ¼ Pass")'));
                if (printPassLine) {
                    if (printPassLine !== expectedLines[1]) {
                        isCorrect = false;
                        hint = "âŒ åŠæ ¼è¼¸å‡ºè¡Œç¸®æ’éŒ¯èª¤ï¼Œè«‹å‹™å¿…ä½¿ç”¨ã€Œ4 å€‹ç©ºæ ¼ã€ï¼æˆ–è€…èªæ³•æœ‰èª¤ã€‚";
                    }
                } else if (isCorrect) {
                    isCorrect = false;
                    hint = "âŒ æ‰¾ä¸åˆ°åŠæ ¼è¼¸å‡ºè¡Œ (print(\"åŠæ ¼ Pass\"))ï¼Œè«‹æª¢æŸ¥ã€‚";
                }
                
                // 3. Check ELSE line: Should be at the start of a line (no leading spaces)
                const elseLine = lines.find(l => l.trim().startsWith('else'));
                if (!elseLine || elseLine.trim() !== expectedLines[2].trim()) {
                     isCorrect = false;
                     hint = "âŒ è™•ç†å…¶é¤˜æƒ…æ³çš„è¡Œ (else) èªæ³•éŒ¯èª¤ï¼Œæ­£ç¢ºæ‡‰ç‚ºï¼šelse:";
                }
                
                // 4. Check second action line (needs 4 spaces prefix)
                const printFailLine = lines.find(l => l.includes('print("ä¸åŠæ ¼ Fail")'));
                if (printFailLine) {
                    if (printFailLine !== expectedLines[3]) {
                        isCorrect = false;
                        hint = "âŒ ä¸åŠæ ¼è¼¸å‡ºè¡Œç¸®æ’éŒ¯èª¤ï¼Œè«‹å‹™å¿…ä½¿ç”¨ã€Œ4 å€‹ç©ºæ ¼ã€ï¼æˆ–è€…èªæ³•æœ‰èª¤ã€‚";
                    }
                } else if (isCorrect) {
                    isCorrect = false;
                    hint = "âŒ æ‰¾ä¸åˆ°ä¸åŠæ ¼è¼¸å‡ºè¡Œ (print(\"ä¸åŠæ ¼ Fail\"))ï¼Œè«‹æª¢æŸ¥ã€‚";
                }
            }

            if (isCorrect) {
                msg.innerText = "âœ… ä»£ç¢¼çµæ§‹ã€é—œéµå­—å’Œç¸®æ’å…¨éƒ¨æ­£ç¢ºï¼";
                msg.className = "mt-2 text-center text-sm font-bold text-green-600";
            } else {
                msg.innerText = hint;
                msg.className = "mt-2 text-sm font-bold text-red-500 whitespace-pre-line";
            }
        }


        // Initialize All Components on Load
        window.onload = function() {
            // 0. Simulator Init
            startSimulator();
            
            // 1. Boolean Init
            checkBoolean();
            
            // 3. Syntax Workshop Init
            updateSingle();
            updateDouble();
            initMultiChart();
            
            // 4. Quiz 2 Init: Set initial value in the editor for guidance
            const quiz2Editor = document.getElementById('quiz-2-code-editor');
            if (quiz2Editor && quiz2Editor.value.trim() === 'score = 65 # ç¯„ä¾‹åˆ†æ•¸') {
                quiz2Editor.value = `score = 65 # ç¯„ä¾‹åˆ†æ•¸

#å¡«å…¥æ¢ä»¶èªå¥é—œéµå­—å’Œã€ç¬¦è™Ÿå’Œç¸®æ’ï¼Œå®Œæˆä¸‹æ–¹ç¨‹å¼ç¢¼
score  50
print("åŠæ ¼ Pass")
:
print("ä¸åŠæ ¼ Fail")`;
            }
        };

    </script>
</body>
</html>